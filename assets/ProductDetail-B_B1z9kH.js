var $=t=>{throw TypeError(t)};var I=(t,s,r)=>s.has(t)||$("Cannot "+r);var l=(t,s,r)=>(I(t,s,"read from private field"),r?r.call(t):s.get(t)),g=(t,s,r)=>s.has(t)?$("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(t):s.set(t,r),m=(t,s,r,a)=>(I(t,s,"write to private field"),a?a.call(t,r):s.set(t,r),r),b=(t,s,r)=>(I(t,s,"access private method"),r);import{d as se,n as q,e as te,Q as X,g as re,h as ne,i as ae,r as v,k as ie,l as oe,m as ce,o as le,s as W,p as U,w as de,q as ue,c as K,t as he,u as _,j as e,S as Y,f as M,a as me,L as Z}from"./index-CYpEEXez.js";import{a as xe}from"./apiProduct-B0VukgiZ.js";import{a as G,C as fe}from"./CategoryCard-BC-LgW10.js";import"./supabase-DCwEJslB.js";function J(t,s){return t.filter(r=>!s.includes(r))}function ge(t,s,r){const a=t.slice(0);return a[s]=r,a}var O,x,R,C,f,N,Q,P,E,h,z,B,A,H,F,V,be=(V=class extends se{constructor(s,r,a){super();g(this,h);g(this,O);g(this,x);g(this,R);g(this,C);g(this,f);g(this,N);g(this,Q);g(this,P);g(this,E,[]);m(this,O,s),m(this,C,a),m(this,R,[]),m(this,f,[]),m(this,x,[]),this.setQueries(r)}onSubscribe(){this.listeners.size===1&&l(this,f).forEach(s=>{s.subscribe(r=>{b(this,h,H).call(this,s,r)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,l(this,f).forEach(s=>{s.destroy()})}setQueries(s,r,a){m(this,R,s),m(this,C,r),q.batch(()=>{const i=l(this,f),n=b(this,h,A).call(this,l(this,R));m(this,E,n),n.forEach(c=>c.observer.setOptions(c.defaultedQueryOptions,a));const o=n.map(c=>c.observer),d=o.map(c=>c.getCurrentResult()),p=o.some((c,k)=>c!==i[k]);i.length===o.length&&!p||(m(this,f,o),m(this,x,d),this.hasListeners()&&(J(i,o).forEach(c=>{c.destroy()}),J(o,i).forEach(c=>{c.subscribe(k=>{b(this,h,H).call(this,c,k)})}),b(this,h,F).call(this)))})}getCurrentResult(){return l(this,x)}getQueries(){return l(this,f).map(s=>s.getCurrentQuery())}getObservers(){return l(this,f)}getOptimisticResult(s,r){const a=b(this,h,A).call(this,s),i=a.map(n=>n.observer.getOptimisticResult(n.defaultedQueryOptions));return[i,n=>b(this,h,B).call(this,n??i,r),()=>b(this,h,z).call(this,i,a)]}},O=new WeakMap,x=new WeakMap,R=new WeakMap,C=new WeakMap,f=new WeakMap,N=new WeakMap,Q=new WeakMap,P=new WeakMap,E=new WeakMap,h=new WeakSet,z=function(s,r){return r.map((a,i)=>{const n=s[i];return a.defaultedQueryOptions.notifyOnChangeProps?n:a.observer.trackResult(n,o=>{r.forEach(d=>{d.observer.trackProp(o)})})})},B=function(s,r){return r?((!l(this,N)||l(this,x)!==l(this,P)||r!==l(this,Q))&&(m(this,Q,r),m(this,P,l(this,x)),m(this,N,te(l(this,N),r(s)))),l(this,N)):s},A=function(s){const r=new Map(l(this,f).map(i=>[i.options.queryHash,i])),a=[];return s.forEach(i=>{const n=l(this,O).defaultQueryOptions(i),o=r.get(n.queryHash);o?a.push({defaultedQueryOptions:n,observer:o}):a.push({defaultedQueryOptions:n,observer:new X(l(this,O),n)})}),a},H=function(s,r){const a=l(this,f).indexOf(s);a!==-1&&(m(this,x,ge(l(this,x),a,r)),b(this,h,F).call(this))},F=function(){var s;if(this.hasListeners()){const r=l(this,N),a=b(this,h,z).call(this,l(this,x),l(this,E)),i=b(this,h,B).call(this,a,(s=l(this,C))==null?void 0:s.combine);r!==i&&q.batch(()=>{this.listeners.forEach(n=>{n(l(this,x))})})}},V);function pe({queries:t,...s},r){const a=re(),i=ne(),n=ae(),o=v.useMemo(()=>t.map(u=>{const j=a.defaultQueryOptions(u);return j._optimisticResults=i?"isRestoring":"optimistic",j}),[t,a,i]);o.forEach(u=>{ie(u),oe(u,n)}),ce(n);const[d]=v.useState(()=>new be(a,o,s)),[p,c,k]=d.getOptimisticResult(o,s.combine),S=!i&&s.subscribed!==!1;v.useSyncExternalStore(v.useCallback(u=>S?d.subscribe(q.batchCalls(u)):le,[d,S]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),v.useEffect(()=>{d.setQueries(o,s,{listeners:!1})},[o,s,d]);const L=p.some((u,j)=>W(o[j],u))?p.flatMap((u,j)=>{const y=o[j];if(y){const D=new X(a,y);if(W(y,u))return U(y,D,n);de(u,i)&&U(y,D,n)}return[]}):[];if(L.length>0)throw Promise.all(L);const w=p.find((u,j)=>{const y=o[j];return y&&ue({result:u,errorResetBoundary:n,throwOnError:y.throwOnError,query:a.getQueryCache().get(y.queryHash),suspense:y.suspense})});if(w!=null&&w.error)throw w.error;return c(k())}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=K("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=K("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=K("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),ve=()=>{const{SKU:t}=he(),{data:s,error:r,isLoading:a}=_({queryKey:["product",t],queryFn:()=>{if(!t)throw new Error("SKU is required");return xe(t)},enabled:!!t}),{data:i,isLoading:n}=_({queryKey:["productImage",s==null?void 0:s.image],queryFn:()=>s!=null&&s.image?G(s.image):Promise.resolve(null),enabled:!!(s!=null&&s.image)}),o=pe({queries:((s==null?void 0:s.imagePack)||[]).map(c=>({queryKey:["productImage",c],queryFn:()=>G(c)}))}),d=o.map(c=>({url:c.data||null,error:c.error||null,isLoading:c.isLoading})),p=o.some(c=>c.isLoading);return{error:r,product:s||null,image:i||null,imagePack:d,isLoadingProduct:a,isLoadingImage:n,isLoadingImagePack:p}};function Ne(){return e.jsx("div",{className:"mx-auto my-[4.8rem] w-16 aspect-square rounded-full animate-spin",style:{background:`radial-gradient(farthest-side, #4f46e5 94%, transparent) top/10px 10px no-repeat,
          conic-gradient(transparent 30%, #4f46e5)`,WebkitMask:"radial-gradient(farthest-side, transparent calc(100% - 10px), #000 0)"}})}function ke({i:t,name:s,imageUrl:r,selectedImage:a,setSelectedImage:i}){return r?e.jsxs("div",{className:`relative cursor-pointer rounded-md overflow-hidden ${a===r?"ring-2 ring-indigo-500":""}`,onClick:()=>i(r),children:[e.jsx(Y,{className:"absolute inset-0 w-full h-full object-cover"}),e.jsx("img",{src:r,alt:`${s} thumbnail`,className:"relative h-auto w-full object-cover"})]},t):null}function we({product:t}){return e.jsx("table",{className:"table-auto w-full text-center text-stone-600 dark:text-stone-400 ",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"border px-auto py-2",children:t==null?void 0:t.wood}),e.jsx("td",{className:"border px-auto py-2",children:"Wood"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border px-auto py-2",children:t.weight}),e.jsx("td",{className:"border px-auto py-2",children:"Weight"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border px-auto py-2",children:t.height}),e.jsx("td",{className:"border px-auto py-2",children:"Height"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border px-auto py-2",children:t.length}),e.jsx("td",{className:"border px-auto py-2",children:"Length"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border px-auto py-2",children:t.width}),e.jsx("td",{className:"border px-auto py-2",children:"Width"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border px-auto py-2",children:t.shipmentPrice?M(t.shipmentPrice):M(0)}),e.jsx("td",{className:"border px-auto py-2",children:"Shipment Price"})]})]})})}const Fe=()=>{const t=me(),[s,r]=v.useState(1),[a,i]=v.useState(null),{product:n,image:o,imagePack:d,isLoadingProduct:p,isLoadingImage:c,isLoadingImagePack:k,error:S}=ve();if(v.useEffect(()=>{o&&i(o)},[o]),p||!n)return e.jsx(Ne,{});const T=w=>{const u=parseInt(w.target.value);!isNaN(u)&&u>0&&r(u)},L=()=>{t("/order",{state:{productId:n.id,productName:n.name,quantity:s}})};return e.jsx("div",{className:"dark:bg-zinc-900 dark:text-white ",dir:"rtl",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(Ie,{product:n}),e.jsxs("div",{className:"lg:grid lg:grid-cols-2 lg:gap-x-8",children:[e.jsx(qe,{image:o,imagePack:d,isLoadingImage:c||p,selectedImage:a,setSelectedImage:i,name:n.name}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-4 items-center",children:[e.jsx("h1",{className:"text-3xl font-extrabold text-zinc-900 dark:text-stone-200 ",children:n.name}),e.jsx(Se,{product:n})]}),e.jsx(Re,{product:n}),e.jsx(Oe,{product:n}),e.jsx(Pe,{product:n}),e.jsxs("div",{className:"border-t border-stone-200 dark:border-stone-700 pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(Ee,{product:n}),e.jsx(Ce,{quantity:s,setQuantity:r,handleQuantityChange:T})]}),e.jsx(Qe,{handleOrder:L}),e.jsx(Le,{})]})]})]})]})})};function Oe({product:t}){return e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-zinc-900 dark:text-stone-200 mb-2",children:"מידע נוסף"}),e.jsx(we,{product:t})]})}function Re({product:t}){return e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-zinc-900 dark:text-stone-200 mb-2",children:"תיאור"}),e.jsx("p",{className:"text-stone-600 dark:text-stone-400",children:t.longDescription})]})}function Ce({quantity:t,setQuantity:s,handleQuantityChange:r}){return e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{type:"button",onClick:()=>s(t+1),className:"p-2 border border-stone-300 dark:border-stone-700 rounded-r-md bg-stone-50 text-stone-500 hover:bg-stone-100 dark:bg-zinc-900 dark:text-white",children:"+"}),e.jsx("input",{type:"number",id:"quantity",name:"quantity",min:"1",value:t,onChange:r,className:"p-2 w-16 border-t border-b border-stone-300 dark:border-stone-700 text-center focus:ring-indigo-500 focus:border-indigo-500 rounded-none dark:bg-zinc-900 dark:text-white"}),e.jsx("button",{type:"button",onClick:()=>t>1&&s(t-1),className:"p-2 border border-stone-300 dark:border-stone-700 rounded-l-md bg-stone-50 text-stone-500 hover:bg-stone-100 dark:bg-zinc-900 dark:text-white",children:"-"}),e.jsx("label",{htmlFor:"quantity",className:"block text-sm font-medium text-stone-600 dark:text-stone-400 mr-4",children:"Quantity"})]})}function Qe({handleOrder:t}){return e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[e.jsxs(Z,{to:"/contact",className:"flex-1 bg-stone-100 text-stone-800 px-6 py-3 rounded-md font-medium hover:bg-stone-200 transition-colors flex items-center justify-center",children:["Ask a Question",e.jsx(ee,{className:"h-5 w-5 mr-2"})]}),e.jsxs("button",{type:"button",onClick:t,className:"flex-1 bg-indigo-600 text-white px-6 py-3 rounded-md font-medium hover:bg-indigo-700 transition-colors flex items-center justify-center",children:["Order Now",e.jsx(je,{className:"h-5 w-5 mr-2"})]})]})}function Pe({product:t}){return e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("div",{className:`h-3 w-3 rounded-full  ${(t==null?void 0:t.stock)===0?"bg-green-500":"bg-yellow-500"} mr-2`}),e.jsxs("span",{className:"text-sm font-medium text-stone-600 dark:text-stone-400",children:["in stock: ",t.stock]})]})}function Ee({product:t}){return e.jsx("p",{className:"text-3xl font-bold text-zinc-900 dark:text-stone-200",children:M(t.price)})}function Le(){return e.jsxs("p",{className:"mt-4 text-sm text-stone-500 dark:text-stone-400 flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"להזמנות גדולות ניתן לפנות לשירות לקוחות"]})}function Se({product:t}){return e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex items-center",children:[...Array(5)].map((s,r)=>e.jsx("svg",{className:`h-5 w-5 ${r<Math.floor(t.rating)?"text-yellow-400":"text-gray-300 dark:text-stone-400"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},r))}),e.jsx("span",{className:"ml-2 text-sm text-gray-600 dark:text-stone-400",children:t.rating})]})}function Ie({product:t}){return e.jsxs("nav",{className:"flex items-center justify-between text-sm font-medium mb-8",dir:"ltr",children:[e.jsxs(Z,{to:"/products",className:"hover:text-gray-900 dark:hover:text-white flex items-center",children:[e.jsx(ye,{className:"h-4 w-4 mr-1"}),"Back to Products"]}),e.jsx(fe,{cat:t.category,type:"detail"})]})}function qe({isLoadingImage:t,image:s,imagePack:r,selectedImage:a,setSelectedImage:i,name:n}){return e.jsxs("div",{className:"mb-8 lg:mb-0",children:[t||!s?e.jsx("div",{className:"aspect-square w-full",children:e.jsx(Y,{className:"w-full h-full object-cover"})}):e.jsx("img",{src:a||"",alt:n,className:"w-full h-auto object-cover rounded-lg mb-4"}),r&&r.length>0&&e.jsx("div",{className:"grid grid-cols-4 gap-2",children:r.map((o,d)=>e.jsx(ke,{imageUrl:o.url||"",i:d,selectedImage:a||"",setSelectedImage:i,name:n},d))})]})}export{Fe as default};
